

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Frequently Asked Questions &mdash; libEnsemble</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/autodoc_pydantic.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/my_theme.css?v=dd6640cf" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />

  
    <link rel="shortcut icon" href="_static/libE_logo_circle.png"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=bcd630d1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
      <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script src="_static/js/theme.js"></script>
    <script src="_static/js/versions.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Known Issues" href="known_issues.html" />
    <link rel="prev" title="Example Scheduler Submission Scripts" href="examples/submission_scripts.html" /> 
<script async type="text/javascript" src="/_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="libensemble" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/FAQ.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/libE_logo_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_installation.html">Advanced Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_usecases.html">Understanding libEnsemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="programming_libE.html">Constructing Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_libE.html">Running libEnsemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="platforms/platforms_index.html">Running on HPC Systems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/local_sine_tutorial.html">Simple Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/executor_forces_tutorial.html">Ensemble with an MPI Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/forces_gpu_tutorial.html">Executor - Assign GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/gpcam_tutorial.html">Surrogate Modeling with gpCAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/aposmm_tutorial.html">Optimization with APOSMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/calib_cancel_tutorial.html">Calibration with Simulation Cancellation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/gen_funcs.html">Generator Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/sim_funcs.html">Simulation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/alloc_funcs.html">Allocation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/calling_scripts.html">Calling Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/submission_scripts.html">Submission Scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional References:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#debugging">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#common-errors">Common Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hpc-errors-and-questions">HPC Errors and Questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#libensemble-help">libEnsemble Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="#macos-and-windows-errors">macOS and Windows Errors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="known_issues.html">Known Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to libEnsemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="posters.html">Posters and Presentations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dev_guide/release_management/release_index.html">Release Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_guide/dev_API/developer_API.html">Internal Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">libEnsemble</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Frequently Asked Questions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/FAQ.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="frequently-asked-questions">
<h1>Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Link to this heading"></a></h1>
<p>If you have any additional questions, feel free to contact us through <a class="reference external" href="https://libensemble.readthedocs.io/en/main/introduction.html#resources">Support</a>.</p>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Link to this heading"></a></h2>
<p>We recommend using the following options to help debug workflows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">libensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>
<span class="n">logger</span><span class="o">.</span><span class="n">set_level</span><span class="p">(</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">)</span>
<span class="n">libE_specs</span><span class="p">[</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>To make it easier to debug a generator try setting the <strong>libE_specs</strong> option <code class="docutils literal notranslate"><span class="pre">gen_on_manager</span></code>.
To do so, add the following to your calling script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">libE_specs</span><span class="p">[</span><span class="s2">&quot;gen_on_manager&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>With this, <code class="docutils literal notranslate"><span class="pre">pdb</span></code> breakpoints can be set as usual in the generator.</p>
<p>For more debugging options see “How can I debug specific libEnsemble processes?” below.</p>
</section>
<section id="common-errors">
<h2>Common Errors<a class="headerlink" href="#common-errors" title="Link to this heading"></a></h2>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>“Manager only - must be at least one worker (2 MPI tasks)” when running with multiprocessing and multiple workers specified.</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">If your code was recently switched from MPI to multiprocessing,
make sure that <a class="reference internal" href="data_structures/libE_specs.html#libensemble.specs.LibeSpecs" title="libensemble.specs.LibeSpecs"><code class="xref py py-class docutils literal notranslate"><span class="pre">libE_specs</span></code></a> is populated
with <code class="docutils literal notranslate"><span class="pre">&quot;comms&quot;:</span> <span class="pre">&quot;local&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;nworkers&quot;:</span> <span class="pre">[int]</span></code>.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>“AssertionError: alloc_f did not return any work, although all workers are idle.”</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">This error occurs when the manager is waiting although all workers are idle.
Note that a worker can be in a persistent state but is marked as idle
when it has returned data to the manager and is ready to receive work.</p>
<p class="sd-card-text">Some possible causes of this error are:</p>
<ul class="simple">
<li><p class="sd-card-text">An MPI libEnsemble run was initiated with only one process, resulting in one
manager but no workers. Similarly, the error may arise when running with only
two processes when using a persistent generator. The generator will occupy
one worker, leaving none to run simulation functions.</p></li>
<li><p class="sd-card-text">An error in the allocation function. For example, perhaps the allocation
waiting for all requested evaluations to be returned (e.g., before starting a
new generator), but this condition
is not returning True even though all scheduled evaluations have returned. This
can be due to incorrect implementation (e.g., it has not considered points that
are cancelled or paused or in some other state that prevents the allocation
function from sending them out to workers).</p></li>
<li><p class="sd-card-text">A persistent worker (usually a generator) has sent a message back to the manager
but is still performing work and may return further points. In this case, consider
starting the generator in <a class="reference internal" href="function_guides/generator.html#gen-active-recv"><span class="std std-ref">active_recv</span></a> mode. This can be
specified in the allocation function and will cause the worker to maintain its
active status.</p></li>
<li><p class="sd-card-text">A persistent worker has requested resources that prevents any simulations from
taking place. By default, persistent workers hold onto resources even when not
active. This may require the worker to return from persistent mode.</p></li>
<li><p class="sd-card-text">When returning points to a persistent generator (often the top code block in
allocation functions). For example, <code class="docutils literal notranslate"><span class="pre">support.avail_worker_ids(persistent=EVAL_GEN_TAG)</span></code>
Make sure that the <code class="docutils literal notranslate"><span class="pre">EVAL_GEN_TAG</span></code> is specified and not just <code class="docutils literal notranslate"><span class="pre">persistent=True</span></code>.</p></li>
</ul>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>libensemble.history (MANAGER_WARNING): Giving entries in H0 back to gen. Marking entries in H0 as ‘gen_informed’ if ‘sim_ended’.</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">This warning is harmless. It’s saying that as the provided History array is being “reloaded” into the generator, the copy is being slightly modified.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>I keep getting: “Not enough processors per worker to honor arguments.” when using the Executor. Can I submit tasks to allocated processors anyway?</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">You may have set <cite>enforce_worker_core_bounds</cite> to True when setting
up the Executor. Also, the resource manager can be completely disabled
with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">libE_specs</span><span class="p">[</span><span class="s2">&quot;disable_resource_manager&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p class="sd-card-text">Note that the Executor <code class="docutils literal notranslate"><span class="pre">submit()</span></code> method has a parameter <code class="docutils literal notranslate"><span class="pre">hyperthreads</span></code>
which will attempt to use all hyperthreads/SMT threads available if set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>FileExistsError: [Errno 17] File exists: “./ensemble”</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">This can happen when libEnsemble tries to create ensemble or simulation directories
that already exist from previous runs. To avoid this, ensure the ensemble directory
paths are unique by appending some unique value to <code class="docutils literal notranslate"><span class="pre">libE_specs[&quot;ensemble_dir_path&quot;]</span></code>,
or automatically instruct runs to operate in unique directories via <code class="docutils literal notranslate"><span class="pre">libE_specs[&quot;use_workflow_dir&quot;]</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>PETSc and MPI errors with “[unset]: write_line error; fd=-1 buf=:cmd=abort exitcode=59”</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">[test</span> <span class="pre">with</span> <span class="pre">PETSc].py</span> <span class="pre">--nworkers</span> <span class="pre">4</span></code></p>
<p class="sd-card-text">This error occurs on some platforms when using PETSc with libEnsemble
in <code class="docutils literal notranslate"><span class="pre">local</span></code> (multiprocessing) mode. We believe this is due to PETSc initializing MPI
before libEnsemble forks processes using multiprocessing. The recommended solution
is running libEnsemble in MPI mode. An alternative solution may be using a serial
build of PETSc.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="sd-card-text">This error may depend on how multiprocessing handles an existing MPI
communicator in a particular platform.</p>
</div>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>“UserWarning: Pydantic serializer warnings:Unexpected extra items present in tuple</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">This warning happens with Pydantic 2.6.0. Upgrading to the latest version
(2.6.1+) should remove the warning.</p>
</div>
</details></section>
<section id="hpc-errors-and-questions">
<h2>HPC Errors and Questions<a class="headerlink" href="#hpc-errors-and-questions" title="Link to this heading"></a></h2>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Why does libEnsemble hang on certain systems when running with MPI?</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Another symptom may be the manager only communicating with Worker 1. This issue
may occur if matching probes, which mpi4py uses by default, are not supported
by the communications fabric, like Intel’s Truescale (TMI) fabric. This can be
solved by switching fabrics or disabling matching probes before the MPI module
is first imported.</p>
<p class="sd-card-text">Add these two lines BEFORE <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mpi4py</span> <span class="pre">import</span> <span class="pre">MPI</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">mpi4py</span>
<span class="n">mpi4py</span><span class="o">.</span><span class="n">rc</span><span class="o">.</span><span class="n">recv_mprobe</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p class="sd-card-text">Also see <a class="reference external" href="https://software.intel.com/en-us/articles/python-mpi4py-on-intel-true-scale-and-omni-path-clusters">https://software.intel.com/en-us/articles/python-mpi4py-on-intel-true-scale-and-omni-path-clusters</a>.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>can’t open hfi unit: -1 (err=23) - [13] MPI startup(): tmi fabric is not available and fallback fabric is not enabled</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">This may occur on TMI when libEnsemble Python processes have been launched to a
node and these, in turn, execute tasks on the node; creating too many processes
for the available contexts. Note that while processes can share contexts, the
system is confused by the fact that there are two phases: first libEnsemble
processes and then subprocesses to run user tasks. The solution is to either
reduce the number of processes running or to specify a fallback fabric through
environment variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unset</span> <span class="n">I_MPI_FABRICS</span>
<span class="n">export</span> <span class="n">I_MPI_FABRICS_LIST</span><span class="o">=</span><span class="n">tmi</span><span class="p">,</span><span class="n">tcp</span>
<span class="n">export</span> <span class="n">I_MPI_FALLBACK</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p class="sd-card-text">Alternatively, libEnsemble can be run in central mode where all workers run on dedicated
nodes while launching all tasks onto other nodes. To do this add a node for libEnsemble,
and add <code class="docutils literal notranslate"><span class="pre">libE_specs[&quot;dedicated_mode&quot;]</span> <span class="pre">=</span> <span class="pre">True</span></code> to your calling script.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>What does “_pickle.UnpicklingError: invalid load key, “x00”.” indicate?</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">This has been observed with the OFA fabric when using mpi4py and usually
indicates MPI messages aren’t being received correctly. The solution
is to either switch fabric or turn off matching probes. See the answer to “Why
does libEnsemble hang on certain systems when running with MPI?”</p>
<p class="sd-card-text">For more information see <a class="reference external" href="https://bitbucket.org/mpi4py/mpi4py/issues/102/unpicklingerror-on-commrecv-after-iprobe">https://bitbucket.org/mpi4py/mpi4py/issues/102/unpicklingerror-on-commrecv-after-iprobe</a>.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>srun: Job ****** step creation temporarily disabled, retrying (Requested nodes are busy)</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Note that this message has been observed on Perlmutter when none of the problems
below are present, and is likely caused by interference with system processes
that run between tasks. In this case, it may cause overhead but does not prevent
correct functioning.</p>
<p class="sd-card-text">When running on a SLURM system, this implies that you are trying to run on a resource
that is already dedicated to another task. The reason can vary, some reasons are:</p>
<ul>
<li><p class="sd-card-text">All the contexts are in use. This has occurred when using TMI fabric on clusters.
See question <strong>can’t open hfi unit: -1 (err=23)</strong> for more info.</p></li>
<li><p class="sd-card-text">All the memory is assigned to the first job-step (srun application), due to a default
exclusive mode scheduling policy. This has been observed on <a class="reference external" href="https://docs.nersc.gov/systems/perlmutter/architecture/">Perlmutter</a> and <a class="reference external" href="https://sdf.slac.stanford.edu/public/doc/#/?id=what-is-the-sdf">SDF</a>.</p>
<p class="sd-card-text">In some cases using these environment variables will stop the issue:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">SLURM_EXACT</span><span class="o">=</span><span class="mi">1</span>
<span class="n">export</span> <span class="n">SLURM_MEM_PER_NODE</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
<p class="sd-card-text">Alternatively, this can be resolved by limiting the memory and other
resources given to each task using the <code class="docutils literal notranslate"><span class="pre">--exact</span></code> <a class="reference external" href="https://docs.nersc.gov/systems/perlmutter/running-jobs/#single-gpu-tasks-in-parallel">option to srun</a> along with other
relevant options. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">srun</span> <span class="o">--</span><span class="n">exact</span> <span class="o">-</span><span class="n">n</span> <span class="mi">4</span> <span class="o">-</span><span class="n">c</span> <span class="mi">1</span> <span class="o">--</span><span class="n">mem</span><span class="o">-</span><span class="n">per</span><span class="o">-</span><span class="n">cpu</span><span class="o">=</span><span class="mi">4</span><span class="n">G</span>
</pre></div>
</div>
<p class="sd-card-text">would ensure that one CPU and 4 Gigabytes of memory are assigned to each MPI process.
The amount of memory should be determined by the memory on the node divided by
the number of CPUs. In the executor, this can be expressed via the <code class="docutils literal notranslate"><span class="pre">extra_args</span></code> option.</p>
<p class="sd-card-text">If libEnsemble is sharing nodes with submitted tasks (user applications launched by workers),
then you may need to do this for your launch of libEnsemble also, ensuring there are enough
resources for both the libEnsemble manager and workers and the launched tasks. If this is
complicated, we recommended using a <a class="reference internal" href="platforms/platforms_index.html"><span class="doc">dedicated node for libEnsemble</span></a>.</p>
</li>
</ul>
</div>
</details></section>
<section id="libensemble-help">
<h2>libEnsemble Help<a class="headerlink" href="#libensemble-help" title="Link to this heading"></a></h2>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>How can I debug specific libEnsemble processes?</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">This is most easily addressed when running libEnsemble locally. Try</p>
<p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">mpiexec</span> <span class="pre">-np</span> <span class="pre">[num</span> <span class="pre">processes]</span> <span class="pre">xterm</span> <span class="pre">-e</span> <span class="pre">&quot;python</span> <span class="pre">[calling</span> <span class="pre">script].py&quot;</span></code></p>
<p class="sd-card-text">to launch an xterm terminal window specific to each process. Mac users will
need to install <a class="reference external" href="https://www.xquartz.org/">xQuartz</a>.</p>
<p class="sd-card-text">If running in <code class="docutils literal notranslate"><span class="pre">local</span></code> mode, try using one of the <code class="docutils literal notranslate"><span class="pre">ForkablePdb</span></code>
routines in <code class="docutils literal notranslate"><span class="pre">libensemble.tools</span></code> to set breakpoints and debug similarly
to <code class="docutils literal notranslate"><span class="pre">pdb</span></code>. How well this works varies by system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">libensemble.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForkablePdb</span>
<span class="n">ForkablePdb</span><span class="p">()</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Can I use the MPI Executor when running libEnsemble with multiprocessing?</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text"><strong>Yes</strong>. The Executor type determines only how libEnsemble workers
execute and interact with user applications and is <em>independent</em> of <code class="docutils literal notranslate"><span class="pre">comms</span></code> chosen
for manager/worker communications.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>How can I disable libEnsemble’s output files?</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Set <code class="docutils literal notranslate"><span class="pre">libE_specs[&quot;disable_log_files&quot;]</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p class="sd-card-text">If libEnsemble aborts on an exception, the History array and <code class="docutils literal notranslate"><span class="pre">persis_info</span></code>
dictionaries will be dumped. This can be suppressed by
setting <code class="docutils literal notranslate"><span class="pre">libE_specs[&quot;save_H_and_persis_on_abort&quot;]</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p class="sd-card-text">See <a class="reference internal" href="history_output_logging.html"><span class="doc">here</span></a> for more information about these files.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>How can I silence libEnsemble or prevent printed warnings?</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Some logger messages at or above the <code class="docutils literal notranslate"><span class="pre">MANAGER_WARNING</span></code> level are mirrored
to stderr automatically. To disable this, set the minimum stderr displaying level
to <code class="docutils literal notranslate"><span class="pre">CRITICAL</span></code> via the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">libensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>
<span class="n">logger</span><span class="o">.</span><span class="n">set_stderr_level</span><span class="p">(</span><span class="s2">&quot;CRITICAL&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sd-card-text">This effectively puts libEnsemble in silent mode.</p>
<p class="sd-card-text">See the <a class="reference internal" href="history_output_logging.html#logger-config"><span class="std std-ref">Logger Configuration</span></a> docs for more information.</p>
</div>
</details></section>
<section id="macos-and-windows-errors">
<h2>macOS and Windows Errors<a class="headerlink" href="#macos-and-windows-errors" title="Link to this heading"></a></h2>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3" id="faqwindows">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Can I run libEnsemble on Windows?</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Although we have run many libEnsemble workflows successfully on Windows using
both MPI and local comms, Windows is not rigorously supported. We highly
recommend Unix-like systems. Windows tends to produce more platform-specific
issues that are difficult to reproduce and troubleshoot.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Windows - How can I run libEnsemble with MPI comms?</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">We have run Windows workflows with MPI comms. However, as most MPI
distributions have either dropped Windows support (MPICH and Open MPI) or are
no longer being maintained (<code class="docutils literal notranslate"><span class="pre">msmpi</span></code>), we cannot guarantee success.</p>
<p class="sd-card-text">We recommend experimenting with the many Unix-like
emulators, containers, virtual machines, and other such systems. The
<a class="reference external" href="https://petsc.org/release/install/windows/#recommended-installation-methods">Installing PETSc On Microsoft Windows</a> documentation contains valuable
information.</p>
<p class="sd-card-text">Otherwise, install <code class="docutils literal notranslate"><span class="pre">msmpi</span></code> and <code class="docutils literal notranslate"><span class="pre">mpi4py</span></code> from conda and experiment, or use <code class="docutils literal notranslate"><span class="pre">local</span></code> comms.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Windows - “A required privilege is not held by the client”</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Assuming you were trying to use the <code class="docutils literal notranslate"><span class="pre">sim_dir_symlink_files</span></code> or <code class="docutils literal notranslate"><span class="pre">gen_dir_symlink_files</span></code> options, this indicates that to
allow libEnsemble to create symlinks, you need to run your current <code class="docutils literal notranslate"><span class="pre">cmd</span></code> shell as administrator.</p>
<p class="sd-card-text"><strong>“RuntimeError: An attempt has been made to start a new process… this probably means that you are not using fork…
“ if __name__ == “__main__”: freeze_support() …</strong></p>
<p class="sd-card-text">You need to place your main entry point code underneath an <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">&quot;__main__&quot;:</span></code> block.</p>
<p class="sd-card-text">Explanation: Python chooses one of three methods to start new processes when using multiprocessing
(<code class="docutils literal notranslate"><span class="pre">--comms</span> <span class="pre">local</span></code> with libEnsemble). These are <code class="docutils literal notranslate"><span class="pre">&quot;fork&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;spawn&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;forkserver&quot;</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;fork&quot;</span></code>
is the default on Unix, and in our experience is quicker and more reliable, but <code class="docutils literal notranslate"><span class="pre">&quot;spawn&quot;</span></code> is the default
on Windows and macOS (See the <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html">Python multiprocessing docs</a>).</p>
<p class="sd-card-text">Prior to libEnsemble v0.9.2, if libEnsemble detected macOS, it would automatically switch the multiprocessing
method to <code class="docutils literal notranslate"><span class="pre">&quot;fork&quot;</span></code>. We decided to stop doing this to avoid overriding defaults and compatibility issues with
some libraries.</p>
<p class="sd-card-text">If you’d prefer to use <code class="docutils literal notranslate"><span class="pre">&quot;fork&quot;</span></code> or not reformat your code, you can set the
multiprocessing start method by placing
the following near the top of your calling script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">multiprocessing</span>
<span class="n">multiprocessing</span><span class="o">.</span><span class="n">set_start_method</span><span class="p">(</span><span class="s2">&quot;fork&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>“macOS - Fatal error in MPI_Init_thread: Other MPI error, error stack: … gethostbyname failed”</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Resolve this by appending <code class="docutils literal notranslate"><span class="pre">127.0.0.1</span>&#160;&#160; <span class="pre">[your</span> <span class="pre">hostname]</span></code> to /etc/hosts.
Unfortunately, <code class="docutils literal notranslate"><span class="pre">127.0.0.1</span>&#160;&#160; <span class="pre">localhost</span></code> isn’t satisfactory for preventing this.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>macOS - How do I stop the Firewall Security popups when running with the Executor?</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">There are several ways to address this nuisance, but all involve trial and error.
An easy (but insecure) solution is temporarily disabling the firewall through
System Preferences -&gt; Security &amp; Privacy -&gt; Firewall -&gt; Turn Off Firewall.
Alternatively, adding a firewall “Allow incoming connections” rule can be
attempted for the offending executable. We’ve had limited success running
<code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">codesign</span> <span class="pre">--force</span> <span class="pre">--deep</span> <span class="pre">--sign</span> <span class="pre">-</span> <span class="pre">/path/to/application.app</span></code>
on our executables, then confirming the next alerts for the executable
and <code class="docutils literal notranslate"><span class="pre">mpiexec.hydra</span></code>.</p>
</div>
</details></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="examples/submission_scripts.html" class="btn btn-neutral float-left" title="Example Scheduler Submission Scripts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="known_issues.html" class="btn btn-neutral float-right" title="Known Issues" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 Argonne National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>