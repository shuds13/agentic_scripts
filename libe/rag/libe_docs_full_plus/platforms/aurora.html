

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aurora &mdash; libEnsemble</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/my_theme.css?v=dd6640cf" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />

  
    <link rel="shortcut icon" href="../_static/libE_logo_circle.png"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=bcd630d1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/theme.js"></script>
    <script src="../_static/js/versions.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bebop" href="bebop.html" />
    <link rel="prev" title="Running on HPC Systems" href="platforms_index.html" /> 
<script async type="text/javascript" src="/_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="libensemble" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/platforms/aurora.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/libE_logo_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_installation.html">Advanced Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview_usecases.html">Understanding libEnsemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming_libE.html">Constructing Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_libE.html">Running libEnsemble</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="platforms_index.html">Running on HPC Systems</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="platforms_index.html#centralized-running">Centralized Running</a></li>
<li class="toctree-l2"><a class="reference internal" href="platforms_index.html#distributed-running">Distributed Running</a></li>
<li class="toctree-l2"><a class="reference internal" href="platforms_index.html#configuring-the-run">Configuring the Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="platforms_index.html#mapping-tasks-to-resources">Mapping Tasks to Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="platforms_index.html#zero-resource-workers">Zero-resource workers</a></li>
<li class="toctree-l2"><a class="reference internal" href="platforms_index.html#assigning-gpus">Assigning GPUs</a></li>
<li class="toctree-l2"><a class="reference internal" href="platforms_index.html#varying-resources">Varying resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="platforms_index.html#overriding-auto-detection">Overriding Auto-Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="platforms_index.html#systems-with-launch-mom-nodes">Systems with Launch/MOM Nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="platforms_index.html#globus-compute-remote-user-functions">Globus Compute - Remote User Functions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="platforms_index.html#instructions-for-specific-platforms">Instructions for Specific Platforms</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Aurora</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuring-python-and-installation">Configuring Python and Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#live-viewing-gpu-usage">Live viewing GPU usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-tiles-as-gpus">Using tiles as GPUs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-generator-on-the-manager">Running generator on the manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dynamic-resource-assignment">Dynamic resource assignment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#demonstration">Demonstration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bebop.html">Bebop</a></li>
<li class="toctree-l3"><a class="reference internal" href="frontier.html">Frontier</a></li>
<li class="toctree-l3"><a class="reference internal" href="improv.html">Improv</a></li>
<li class="toctree-l3"><a class="reference internal" href="perlmutter.html">Perlmutter</a></li>
<li class="toctree-l3"><a class="reference internal" href="polaris.html">Polaris</a></li>
<li class="toctree-l3"><a class="reference internal" href="summit.html">Summit (Decommissioned)</a></li>
<li class="toctree-l3"><a class="reference internal" href="srun.html">libEnsemble with SLURM</a></li>
<li class="toctree-l3"><a class="reference internal" href="example_scripts.html">Example Scheduler Submission Scripts</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/local_sine_tutorial.html">Simple Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/executor_forces_tutorial.html">Ensemble with an MPI Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/forces_gpu_tutorial.html">Executor - Assign GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/gpcam_tutorial.html">Surrogate Modeling with gpCAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/aposmm_tutorial.html">Optimization with APOSMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/calib_cancel_tutorial.html">Calibration with Simulation Cancellation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/gen_funcs.html">Generator Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/sim_funcs.html">Simulation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/alloc_funcs.html">Allocation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/calling_scripts.html">Calling Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/submission_scripts.html">Submission Scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional References:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../known_issues.html">Known Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to libEnsemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../posters.html">Posters and Presentations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/release_management/release_index.html">Release Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/dev_API/developer_API.html">Internal Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">libEnsemble</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="platforms_index.html">Running on HPC Systems</a></li>
      <li class="breadcrumb-item active">Aurora</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/platforms/aurora.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="aurora">
<h1>Aurora<a class="headerlink" href="#aurora" title="Link to this heading"></a></h1>
<p><a class="reference external" href="https://www.alcf.anl.gov/support-center/aurorasunspot/getting-started-aurora">Aurora</a> is an Intel/HPE EX supercomputer located in the <a class="reference external" href="https://www.alcf.anl.gov/">ALCF</a> at Argonne
National Laboratory. Each compute node contains two Intel (Sapphire Rapids)
Xeon CPUs and six Intel X<sup>e</sup> GPUs (Ponte Vecchio), each with two tiles.</p>
<p>The PBS scheduler is used to submit jobs from login nodes to run on compute
nodes.</p>
<section id="configuring-python-and-installation">
<h2>Configuring Python and Installation<a class="headerlink" href="#configuring-python-and-installation" title="Link to this heading"></a></h2>
<p>To obtain Python and create a virtual environment:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">module load frameworks</span>
<span class="go">python -m venv /path/to-venv --system-site-packages</span>
<span class="go">. /path/to-venv/bin/activate</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">/path/to-venv</span></code> can be anywhere you have write access. For future sessions,
just load the frameworks module and run the activate line.</p>
<p>To obtain libEnsemble:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">libensemble</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../advanced_installation.html"><span class="doc">here</span></a> for more information on advanced
options for installing libEnsemble, including using Spack.</p>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h2>
<p>To run the <a class="reference internal" href="../tutorials/forces_gpu_tutorial.html"><span class="doc">forces_gpu</span></a> tutorial on
Aurora.</p>
<p>To obtain the example you can git clone libEnsemble - although only
the <code class="docutils literal notranslate"><span class="pre">forces</span></code> sub-directory is strictly needed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">Libensemble</span><span class="o">/</span><span class="n">libensemble</span>
<span class="n">cd</span> <span class="n">libensemble</span><span class="o">/</span><span class="n">libensemble</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">scaling_tests</span><span class="o">/</span><span class="n">forces</span><span class="o">/</span><span class="n">forces_app</span>
</pre></div>
</div>
<p>To compile forces (a C with OpenMP target application):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpicc</span> <span class="o">-</span><span class="n">DGPU</span> <span class="o">-</span><span class="n">O3</span> <span class="o">-</span><span class="n">fiopenmp</span> <span class="o">-</span><span class="n">fopenmp</span><span class="o">-</span><span class="n">targets</span><span class="o">=</span><span class="n">spir64</span> <span class="o">-</span><span class="n">o</span> <span class="n">forces</span><span class="o">.</span><span class="n">x</span> <span class="n">forces</span><span class="o">.</span><span class="n">c</span>
</pre></div>
</div>
<p>Now go to forces_gpu directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">../</span><span class="n">forces_gpu</span>
</pre></div>
</div>
<p>To make use of all available GPUs, open <strong>run_libe_forces.py</strong> and adjust
the <code class="docutils literal notranslate"><span class="pre">exit_criteria</span></code> to perform more simulations. The following will run two
simulations for each worker:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instruct libEnsemble to exit after this many simulations</span>
<span class="n">ensemble</span><span class="o">.</span><span class="n">exit_criteria</span> <span class="o">=</span> <span class="n">ExitCriteria</span><span class="p">(</span><span class="n">sim_max</span><span class="o">=</span><span class="n">nsim_workers</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Now grab an interactive session on two nodes (or use the batch script at
<code class="docutils literal notranslate"><span class="pre">../submission_scripts/submit_pbs_aurora.sh</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qsub</span> <span class="o">-</span><span class="n">A</span> <span class="o">&lt;</span><span class="n">myproject</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">l</span> <span class="n">select</span><span class="o">=</span><span class="mi">2</span> <span class="o">-</span><span class="n">l</span> <span class="n">walltime</span><span class="o">=</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span> <span class="o">-</span><span class="n">lfilesystems</span><span class="o">=</span><span class="n">home</span><span class="p">:</span><span class="n">flare</span> <span class="o">-</span><span class="n">q</span> <span class="n">debug</span> <span class="o">-</span><span class="n">I</span>
</pre></div>
</div>
<p>Once in the interactive session, you may need to reload the frameworks module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $PBS_O_WORKDIR
. /path/to-venv/bin/activate
</pre></div>
</div>
<p>Then in the session run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">run_libe_forces</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">n</span> <span class="mi">13</span>
</pre></div>
</div>
<p>This provides twelve workers for running simulations (one for each GPU across
two nodes). An extra worker is added to run the persistent generator. The
GPU settings for each worker simulation are printed.</p>
<p>Looking at <code class="docutils literal notranslate"><span class="pre">libE_stats.txt</span></code> will provide a summary of the runs.</p>
<p>Now try running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">cleanup</span><span class="o">.</span><span class="n">sh</span>
<span class="n">python</span> <span class="n">run_libe_forces</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">n</span> <span class="mi">7</span>
</pre></div>
</div>
<p>And you will see it runs with two cores and two GPUs are used per
worker. The <strong>forces</strong> example automatically uses the GPUs available to
each worker.</p>
</section>
<section id="live-viewing-gpu-usage">
<h2>Live viewing GPU usage<a class="headerlink" href="#live-viewing-gpu-usage" title="Link to this heading"></a></h2>
<p>To see GPU usage, SSH into a compute node you are on in another window and run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">xpu</span><span class="o">-</span><span class="n">smi</span>
<span class="n">watch</span> <span class="o">-</span><span class="n">n</span> <span class="mf">0.1</span> <span class="n">xpu</span><span class="o">-</span><span class="n">smi</span> <span class="n">dump</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="n">m</span> <span class="mi">0</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="using-tiles-as-gpus">
<h2>Using tiles as GPUs<a class="headerlink" href="#using-tiles-as-gpus" title="Link to this heading"></a></h2>
<p>To treat each tile as its own GPU, add the <code class="docutils literal notranslate"><span class="pre">use_tiles_as_gpus=True</span></code> option
to the <code class="docutils literal notranslate"><span class="pre">libE_specs</span></code> block in <strong>run_libe_forces.py</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ensemble</span><span class="o">.</span><span class="n">libE_specs</span> <span class="o">=</span> <span class="n">LibeSpecs</span><span class="p">(</span>
    <span class="n">num_resource_sets</span><span class="o">=</span><span class="n">nsim_workers</span><span class="p">,</span>
    <span class="n">sim_dirs_make</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">use_tiles_as_gpus</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Now you can run again but with twice the workers for running simulations (each
will use one GPU tile):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">run_libe_forces</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">n</span> <span class="mi">25</span>
</pre></div>
</div>
</section>
<section id="running-generator-on-the-manager">
<h2>Running generator on the manager<a class="headerlink" href="#running-generator-on-the-manager" title="Link to this heading"></a></h2>
<p>An alternative is to run the generator on a thread on the manager. The
number of workers can then be set to the number of simulation workers.</p>
<p>Change the <code class="docutils literal notranslate"><span class="pre">libE_specs</span></code> in <strong>run_libe_forces.py</strong> as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nsim_workers</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">nworkers</span>

<span class="c1"># Persistent gen does not need resources</span>
<span class="n">ensemble</span><span class="o">.</span><span class="n">libE_specs</span> <span class="o">=</span> <span class="n">LibeSpecs</span><span class="p">(</span>
    <span class="n">gen_on_manager</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</pre></div>
</div>
<p>then we can run with 12 (instead of 13) workers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">run_libe_forces</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">n</span> <span class="mi">12</span>
</pre></div>
</div>
</section>
<section id="dynamic-resource-assignment">
<h2>Dynamic resource assignment<a class="headerlink" href="#dynamic-resource-assignment" title="Link to this heading"></a></h2>
<p>In the <strong>forces</strong> directory you will also find:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forces_gpu_var_resources</span></code> uses varying processor/GPU counts per simulation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forces_multi_app</span></code> uses varying processor/GPU counts per simulation and also
uses two different user executables, one which is CPU-only and one which
uses GPUs. This allows highly efficient use of nodes for multi-application
ensembles.</p></li>
</ul>
</section>
<section id="demonstration">
<h2>Demonstration<a class="headerlink" href="#demonstration" title="Link to this heading"></a></h2>
<p>Note that a video <a class="reference external" href="https://youtu.be/H2fmbZ6DnVc">demonstration</a> of the <em>forces_gpu</em> example on <strong>Frontier</strong>
is also available. The workflow is identical when running on Aurora, with the
exception of different compiler options and numbers of workers (because the
numbers of GPUs on a node differs).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="platforms_index.html" class="btn btn-neutral float-left" title="Running on HPC Systems" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bebop.html" class="btn btn-neutral float-right" title="Bebop" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 Argonne National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>